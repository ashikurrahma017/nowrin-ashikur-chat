{% extends "base.html" %}
{% block title %}Chat | Whats chat{% endblock %}

{% block content %}
<div class="whatsapp-layout"
     data-current="{{ current_username }}"
     data-active="{{ active_username or '' }}">

    <!-- LEFT SIDEBAR: ONLY SEARCH -->
    <aside class="sidebar">
        <header class="sidebar-header">
            <div class="profile-circle">{{ current_username[0]|upper }}</div>
            <span class="sidebar-username">{{ current_username }}</span>
            <a class="logout-link" href="{{ url_for('logout') }}">Logout</a>
        </header>

        <div class="sidebar-search">
            <form id="user-search-form">
                <input id="search-username" type="text"
                       placeholder="Search username to chat">
            </form>
        </div>

        <div class="chat-list empty">
            <div class="chat-last">
                Search a username and press Enter to start a personal chat.
            </div>
        </div>
    </aside>

    <!-- MAIN CHAT AREA -->
    <main class="chat-main">
        <header class="chat-header">
            <div class="chat-header-info">
                {% if active_username %}
                    <div class="chat-avatar">{{ active_username[0]|upper }}</div>
                    <div>
                        <div class="chat-title">{{ active_username }}</div>
                        <div class="chat-subtitle">Personal chat</div>
                    </div>
                {% else %}
                    <div>
                        <div class="chat-title">Select a person</div>
                        <div class="chat-subtitle">Search a username on the left to start chatting</div>
                    </div>
                {% endif %}
            </div>
        </header>

        <section class="chat-body" id="messages">
            {% if not active_username %}
            <div class="empty-state">
                <p>Search any username you know and start a private chat â€” just like WhatsApp.</p>
            </div>
            {% endif %}
        </section>

        <footer class="chat-footer">
            <form id="message-form">
                <div class="input-icons">
                    <label for="image-input" class="icon-button" title="Send photo">ðŸ“Ž</label>
                    <input id="image-input" type="file" accept="image/*" style="display:none">
                </div>
                <div class="input-wrapper">
                    <input id="message-input" type="text"
                           placeholder="{% if active_username %}Type a message{% else %}Search a user first{% endif %}"
                           autocomplete="off"
                           {% if not active_username %}disabled{% endif %}>
                </div>
                <button type="submit" class="send-button"
                        {% if not active_username %}disabled{% endif %}>âž¤</button>
            </form>
        </footer>
    </main>
</div>

<script src="{{ url_for('static', filename='script.js') }}"></script>
{% endblock %}
